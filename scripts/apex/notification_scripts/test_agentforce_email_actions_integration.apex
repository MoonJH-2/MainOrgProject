/**
 * @description Agentforce ì´ë©”ì¼ ì•¡ì…˜ í†µí•© í…ŒìŠ¤íŠ¸ ìŠ¤í¬ë¦½íŠ¸
 * @author AI Assistant
 * @created 2025-07-24
 * @usage Developer Console â†’ Execute Anonymousì—ì„œ ì‹¤í–‰
 */

// ========================================
// Agentforce ì´ë©”ì¼ ì•¡ì…˜ í†µí•© í…ŒìŠ¤íŠ¸
// ========================================

System.debug('=== Agentforce ì´ë©”ì¼ ì•¡ì…˜ í†µí•© í…ŒìŠ¤íŠ¸ ì‹œì‘ ===');

// í…ŒìŠ¤íŠ¸ìš© ë°ì´í„° ì¤€ë¹„ (ì‹¤ì œ ë°ì´í„°ë¡œ ë³€ê²½ í•„ìš”)
String testOrderId = '8013m00000EXAMPLE';  // ì‹¤ì œ Order IDë¡œ ë³€ê²½
String testPaymentId = 'a0Y3m00000EXAMPLE'; // ì‹¤ì œ PaymentStatus__c IDë¡œ ë³€ê²½  
String testAssetId = '02i3m00000EXAMPLE';   // ì‹¤ì œ Asset IDë¡œ ë³€ê²½

// ========================================
// í…ŒìŠ¤íŠ¸ 1: Order ì´ë©”ì¼ ì•¡ì…˜
// ========================================
System.debug('\n--- í…ŒìŠ¤íŠ¸ 1: Order í™•ì¸ ì´ë©”ì¼ ---');
try {
    AgentforceOrderEmailAction.EmailRequest orderReq = new AgentforceOrderEmailAction.EmailRequest();
    orderReq.orderId = testOrderId;
    orderReq.emailType = 'Order_Confirmation';
    
    List<AgentforceOrderEmailAction.EmailRequest> orderRequests = 
        new List<AgentforceOrderEmailAction.EmailRequest>{orderReq};
    
    List<AgentforceOrderEmailAction.EmailDraftResult> orderResults = 
        AgentforceOrderEmailAction.draftOrderEmail(orderRequests);
    
    for(AgentforceOrderEmailAction.EmailDraftResult result : orderResults) {
        if(result.success) {
            System.debug('âœ… Order ì´ë©”ì¼ ìƒì„± ì„±ê³µ');
            System.debug('ì œëª©: ' + result.emailSubject);
            System.debug('ìˆ˜ì‹ ì: ' + result.recipientEmail);
            System.debug('ì£¼ë¬¸ë²ˆí˜¸: ' + result.orderNumber);
        } else {
            System.debug('âŒ Order ì´ë©”ì¼ ìƒì„± ì‹¤íŒ¨: ' + result.errorMessage);
        }
    }
} catch(Exception e) {
    System.debug('âŒ Order ì´ë©”ì¼ í…ŒìŠ¤íŠ¸ ì˜¤ë¥˜: ' + e.getMessage());
}

// ========================================
// í…ŒìŠ¤íŠ¸ 2: Payment ì´ë©”ì¼ ì•¡ì…˜
// ========================================
System.debug('\n--- í…ŒìŠ¤íŠ¸ 2: Payment ì•Œë¦¼ ì´ë©”ì¼ ---');
try {
    AgentforcePaymentEmailAction.PaymentEmailRequest paymentReq = 
        new AgentforcePaymentEmailAction.PaymentEmailRequest();
    paymentReq.paymentId = testPaymentId;
    paymentReq.emailType = 'Payment_Reminder';
    
    List<AgentforcePaymentEmailAction.PaymentEmailRequest> paymentRequests = 
        new List<AgentforcePaymentEmailAction.PaymentEmailRequest>{paymentReq};
    
    List<AgentforcePaymentEmailAction.EmailDraftResult> paymentResults = 
        AgentforcePaymentEmailAction.draftPaymentEmail(paymentRequests);
    
    for(AgentforcePaymentEmailAction.EmailDraftResult result : paymentResults) {
        if(result.success) {
            System.debug('âœ… Payment ì´ë©”ì¼ ìƒì„± ì„±ê³µ');
            System.debug('ì œëª©: ' + result.emailSubject);
            System.debug('íƒ€ì…: ' + result.emailType);
            System.debug('ì£¼ë¬¸ë²ˆí˜¸: ' + result.orderNumber);
        } else {
            System.debug('âŒ Payment ì´ë©”ì¼ ìƒì„± ì‹¤íŒ¨: ' + result.errorMessage);
        }
    }
} catch(Exception e) {
    System.debug('âŒ Payment ì´ë©”ì¼ í…ŒìŠ¤íŠ¸ ì˜¤ë¥˜: ' + e.getMessage());
}

// ========================================  
// í…ŒìŠ¤íŠ¸ 3: Asset ì´ë©”ì¼ ì•¡ì…˜
// ========================================
System.debug('\n--- í…ŒìŠ¤íŠ¸ 3: Asset ê°±ì‹  ì´ë©”ì¼ ---');
try {
    AgentforceAssetEmailAction.AssetEmailRequest assetReq = 
        new AgentforceAssetEmailAction.AssetEmailRequest();
    assetReq.assetId = testAssetId;
    assetReq.emailType = 'Renewal_Reminder';
    
    List<AgentforceAssetEmailAction.AssetEmailRequest> assetRequests = 
        new List<AgentforceAssetEmailAction.AssetEmailRequest>{assetReq};
    
    List<AgentforceAssetEmailAction.EmailDraftResult> assetResults = 
        AgentforceAssetEmailAction.draftAssetRenewalEmail(assetRequests);
    
    for(AgentforceAssetEmailAction.EmailDraftResult result : assetResults) {
        if(result.success) {
            System.debug('âœ… Asset ì´ë©”ì¼ ìƒì„± ì„±ê³µ');
            System.debug('ì œëª©: ' + result.emailSubject);
            System.debug('Assetëª…: ' + result.assetName);
            System.debug('íƒ€ì…: ' + result.emailType);
        } else {
            System.debug('âŒ Asset ì´ë©”ì¼ ìƒì„± ì‹¤íŒ¨: ' + result.errorMessage);
        }
    }
} catch(Exception e) {
    System.debug('âŒ Asset ì´ë©”ì¼ í…ŒìŠ¤íŠ¸ ì˜¤ë¥˜: ' + e.getMessage());
}

// ========================================
// í…ŒìŠ¤íŠ¸ 4: ì´ë©”ì¼ ìˆ˜ì • ì•¡ì…˜
// ========================================
System.debug('\n--- í…ŒìŠ¤íŠ¸ 4: ì´ë©”ì¼ ìˆ˜ì • ì•¡ì…˜ ---');
try {
    AgentforceEmailRevisionAction.EmailRevisionRequest revisionReq = 
        new AgentforceEmailRevisionAction.EmailRevisionRequest();
    revisionReq.originalSubject = '[ì•ˆë‚´] Order 00000153 - ì£¼ë¬¸ í™•ì¸ ì•ˆë‚´';
    revisionReq.originalBody = 'ì•ˆë…•í•˜ì„¸ìš”, ê³ ê°ë‹˜\n\nì£¼ë¬¸ì´ ì ‘ìˆ˜ë˜ì—ˆìŠµë‹ˆë‹¤.\n\nê°ì‚¬í•©ë‹ˆë‹¤.';
    revisionReq.revisionType = 'Make_Urgent';
    revisionReq.revisionInstructions = 'ë¹ ë¥¸ í™•ì¸ì´ í•„ìš”í•œ ì£¼ë¬¸ì…ë‹ˆë‹¤';
    
    List<AgentforceEmailRevisionAction.EmailRevisionRequest> revisionRequests = 
        new List<AgentforceEmailRevisionAction.EmailRevisionRequest>{revisionReq};
    
    List<AgentforceEmailRevisionAction.EmailRevisionResult> revisionResults = 
        AgentforceEmailRevisionAction.reviseEmailDraft(revisionRequests);
    
    for(AgentforceEmailRevisionAction.EmailRevisionResult result : revisionResults) {
        if(result.success) {
            System.debug('âœ… ì´ë©”ì¼ ìˆ˜ì • ì„±ê³µ');
            System.debug('ìˆ˜ì • íƒ€ì…: ' + result.revisionType);
            System.debug('ì›ë³¸ ì œëª©: ' + result.originalSubject);
            System.debug('ìˆ˜ì •ëœ ì œëª©: ' + result.revisedSubject);
        } else {
            System.debug('âŒ ì´ë©”ì¼ ìˆ˜ì • ì‹¤íŒ¨: ' + result.errorMessage);
        }
    }
} catch(Exception e) {
    System.debug('âŒ ì´ë©”ì¼ ìˆ˜ì • í…ŒìŠ¤íŠ¸ ì˜¤ë¥˜: ' + e.getMessage());
}

// ========================================
// í…ŒìŠ¤íŠ¸ 5: ì‹¤ì œ ë°ì´í„° ì¡°íšŒ í…ŒìŠ¤íŠ¸
// ========================================
System.debug('\n--- í…ŒìŠ¤íŠ¸ 5: ì‹¤ì œ ë°ì´í„° ì¡´ì¬ í™•ì¸ ---');

// Order ë°ì´í„° í™•ì¸
try {
    List<Order> orders = [SELECT Id, OrderNumber, Account.Name FROM Order LIMIT 3];
    System.debug('ğŸ“‹ ì‚¬ìš© ê°€ëŠ¥í•œ Order ë°ì´í„°:');
    for(Order ord : orders) {
        System.debug('  Order ID: ' + ord.Id + ', ì£¼ë¬¸ë²ˆí˜¸: ' + ord.OrderNumber + ', ê³ ê°: ' + ord.Account.Name);
    }
} catch(Exception e) {
    System.debug('âŒ Order ë°ì´í„° ì¡°íšŒ ì˜¤ë¥˜: ' + e.getMessage());
}

// PaymentStatus ë°ì´í„° í™•ì¸  
try {
    List<SObject> payments = Database.query('SELECT Id, Name, Order__r.OrderNumber FROM PaymentStatus__c LIMIT 3');
    System.debug('ğŸ’° ì‚¬ìš© ê°€ëŠ¥í•œ PaymentStatus ë°ì´í„°:');
    for(SObject payment : payments) {
        System.debug('  Payment ID: ' + payment.Id + ', ì´ë¦„: ' + payment.get('Name') + 
                    ', ì£¼ë¬¸: ' + payment.get('Order__r.OrderNumber'));
    }
} catch(Exception e) {
    System.debug('âŒ PaymentStatus ë°ì´í„° ì¡°íšŒ ì˜¤ë¥˜: ' + e.getMessage());
}

// Asset ë°ì´í„° í™•ì¸
try {
    List<Asset> assets = [SELECT Id, Name, Account.Name, Product2.Name FROM Asset LIMIT 3];
    System.debug('ğŸš— ì‚¬ìš© ê°€ëŠ¥í•œ Asset ë°ì´í„°:');
    for(Asset asset : assets) {
        System.debug('  Asset ID: ' + asset.Id + ', ì´ë¦„: ' + asset.Name + 
                    ', ê³ ê°: ' + asset.Account.Name + ', ì œí’ˆ: ' + asset.Product2.Name);
    }
} catch(Exception e) {
    System.debug('âŒ Asset ë°ì´í„° ì¡°íšŒ ì˜¤ë¥˜: ' + e.getMessage());
}

System.debug('\n=== Agentforce ì´ë©”ì¼ ì•¡ì…˜ í†µí•© í…ŒìŠ¤íŠ¸ ì™„ë£Œ ===');

// ========================================
// ë‹¤ìŒ ë‹¨ê³„ ì•ˆë‚´
// ========================================
System.debug('\nğŸ“‹ ë‹¤ìŒ ë‹¨ê³„:');
System.debug('1. ìœ„ ë¡œê·¸ì—ì„œ ì‹¤ì œ IDë¥¼ í™•ì¸í•˜ì—¬ í…ŒìŠ¤íŠ¸ ìŠ¤í¬ë¦½íŠ¸ ìƒë‹¨ì˜ ë³€ìˆ˜ ì—…ë°ì´íŠ¸');
System.debug('2. Setup â†’ Agentforce Studio â†’ Actionsì—ì„œ ì»¤ìŠ¤í…€ ì•¡ì…˜ ë“±ë¡');
System.debug('3. Agent Builderì—ì„œ Email Communications í† í”½ ì„¤ì •');
System.debug('4. Conversation Previewì—ì„œ ì‹¤ì œ Agent í…ŒìŠ¤íŠ¸');
System.debug('5. ì„±ëŠ¥ ëª¨ë‹ˆí„°ë§ ë° ì˜¤ë¥˜ ì²˜ë¦¬ ê°œì„ ');

/*
========================================
ì‹¤ì œ ì‚¬ìš© ì˜ˆì‹œ (Agentì—ì„œ):
========================================

User: "Order 00000153 í™•ì¸ ì´ë©”ì¼ ì‘ì„±í•´ì¤˜"
â†’ Agentê°€ Draft Order Email ì•¡ì…˜ ì‹¤í–‰

User: "ê²°ì œ ì˜ˆì •ì¼ ì•ˆë‚´ ì´ë©”ì¼ ë§Œë“¤ì–´ì¤˜" 
â†’ Agentê°€ Draft Payment Email ì•¡ì…˜ ì‹¤í–‰

User: "ìœ„ ì´ë©”ì¼ì„ ì¢€ ë” ì •ì¤‘í•˜ê²Œ ìˆ˜ì •í•´ì¤˜"
â†’ Agentê°€ Revise Email Draft ì•¡ì…˜ ì‹¤í–‰

User: "Asset ê°±ì‹  ì‹œê¸° ì•ˆë‚´ ì´ë©”ì¼ ì´ˆì•ˆ ì‘ì„±"
â†’ Agentê°€ Draft Asset Renewal Email ì•¡ì…˜ ì‹¤í–‰

User: "ìµœì¢… ì´ë©”ì¼ ì „ì†¡ ì¤€ë¹„í•´ì¤˜"
â†’ Agentê°€ í‘œì¤€ "Draft or Revise Email" ì•¡ì…˜ ì‹¤í–‰
========================================
*/
