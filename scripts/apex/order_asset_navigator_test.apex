/**
 * OrderAssetNavigator ì»´í¬ë„ŒíŠ¸ í…ŒìŠ¤íŠ¸
 * Orderì—ì„œ Assetìœ¼ë¡œì˜ ë„¤ë¹„ê²Œì´ì…˜ ê¸°ëŠ¥ í…ŒìŠ¤íŠ¸
 */

System.debug('=== OrderAssetNavigator ì»´í¬ë„ŒíŠ¸ í…ŒìŠ¤íŠ¸ ===');

// 1. í…ŒìŠ¤íŠ¸ìš© Order ì„ íƒ
List<Order> testOrders = [
    SELECT Id, OrderNumber, AccountId, Account.Name, TotalAmount
    FROM Order 
    WHERE AccountId != null
    ORDER BY CreatedDate DESC
    LIMIT 3
];

if (testOrders.isEmpty()) {
    System.debug('í…ŒìŠ¤íŠ¸ìš© Orderê°€ ì—†ìŠµë‹ˆë‹¤.');
    return;
}

for (Order ord : testOrders) {
    System.debug('\n--- Order: ' + ord.OrderNumber + ' (' + ord.Account.Name + ') ---');
    
    try {
        // OrderAssetNavigatorController í…ŒìŠ¤íŠ¸
        OrderAssetNavigatorController.OrderAssetInfo assetInfo = 
            OrderAssetNavigatorController.getOrderAssetInfo(ord.Id);
        
        System.debug('ğŸ“Š ë‚©ë¶€ ìš”ì•½:');
        System.debug('  - ì´ ë‚©ë¶€ íšŒì°¨: ' + assetInfo.paymentSummary.totalPayments);
        System.debug('  - ì™„ë£Œëœ íšŒì°¨: ' + assetInfo.paymentSummary.completedPayments);
        System.debug('  - ë‚¨ì€ íšŒì°¨: ' + assetInfo.paymentSummary.remainingPayments);
        System.debug('  - ì™„ë‚© ì—¬ë¶€: ' + assetInfo.paymentSummary.isFullyPaid);
        System.debug('  - ì´ ê¸ˆì•¡: ' + assetInfo.paymentSummary.totalAmount);
        
        if (assetInfo.assetInfo != null) {
            System.debug('âœ… ì—°ê²°ëœ Asset:');
            System.debug('  - Asset ID: ' + assetInfo.assetInfo.Id);
            System.debug('  - Asset ì´ë¦„: ' + assetInfo.assetInfo.Name);
            System.debug('  - Serial Number: ' + assetInfo.assetInfo.SerialNumber);
            System.debug('  - ìƒíƒœ: ' + assetInfo.assetInfo.Status);
            System.debug('  - êµ¬ë§¤ì¼: ' + assetInfo.assetInfo.PurchaseDate);
            System.debug('  - ì„¤ì¹˜ì¼: ' + assetInfo.assetInfo.InstallDate);
        } else {
            System.debug('âŒ ì—°ê²°ëœ Asset ì—†ìŒ');
            
            // ì™„ë‚©ëœ ê²½ìš° Asset ìƒì„± í…ŒìŠ¤íŠ¸
            if (assetInfo.paymentSummary.isFullyPaid) {
                System.debug('ğŸ”„ ì™„ë‚© ìƒíƒœ - Asset ìƒì„± í…ŒìŠ¤íŠ¸ ì§„í–‰');
                
                try {
                    OrderAssetNavigatorController.AssetCreationResult createResult = 
                        OrderAssetNavigatorController.createAssetFromOrder(ord.Id);
                    
                    if (createResult.success) {
                        System.debug('âœ… Asset ìƒì„± ì„±ê³µ: ' + createResult.assetId);
                        System.debug('   ë©”ì‹œì§€: ' + createResult.message);
                    } else {
                        System.debug('âŒ Asset ìƒì„± ì‹¤íŒ¨: ' + createResult.message);
                    }
                } catch (Exception createError) {
                    System.debug('âŒ Asset ìƒì„± ì˜¤ë¥˜: ' + createError.getMessage());
                }
            } else {
                System.debug('â³ ë‚©ë¶€ ë¯¸ì™„ë£Œ - Asset ìƒì„± ë¶ˆê°€');
            }
        }
        
    } catch (Exception e) {
        System.debug('âŒ í…ŒìŠ¤íŠ¸ ì˜¤ë¥˜: ' + e.getMessage());
    }
}

System.debug('\n=== ì»´í¬ë„ŒíŠ¸ ì‚¬ìš© ê°€ì´ë“œ ===');
System.debug('1. Order ë ˆì½”ë“œ í˜ì´ì§€ì— OrderAssetNavigator ì»´í¬ë„ŒíŠ¸ ì¶”ê°€');
System.debug('2. ì»´í¬ë„ŒíŠ¸ê°€ ë‚©ë¶€ ì§„í–‰ë¥ ê³¼ Asset ì—°ê²° ìƒíƒœë¥¼ ìë™ í‘œì‹œ');
System.debug('3. ì™„ë‚© ì‹œ Asset ìƒì„± ë²„íŠ¼ ë˜ëŠ” Asset ë³´ê¸° ë²„íŠ¼ ì œê³µ');
System.debug('4. Assetìœ¼ë¡œ ì›í´ë¦­ ë„¤ë¹„ê²Œì´ì…˜ ê°€ëŠ¥');

System.debug('\n=== ê¸°ëŠ¥ ìš”ì•½ ===');
System.debug('ğŸ“ˆ ë‚©ë¶€ ì§„í–‰ë¥  ì‹œê°í™”');
System.debug('ğŸ”— Order-Asset ì—°ê²° ìƒíƒœ í‘œì‹œ');
System.debug('ğŸš€ Assetìœ¼ë¡œ ì›í´ë¦­ ë„¤ë¹„ê²Œì´ì…˜');
System.debug('ğŸ› ï¸ ì™„ë‚© ì‹œ ìˆ˜ë™ Asset ìƒì„±');
System.debug('ğŸ“± ë°˜ì‘í˜• UI ë””ìì¸');
System.debug('ğŸ”„ ì‹¤ì‹œê°„ ë°ì´í„° ìƒˆë¡œê³ ì¹¨');

System.debug('\nâœ… OrderAssetNavigator ì»´í¬ë„ŒíŠ¸ í…ŒìŠ¤íŠ¸ ì™„ë£Œ!');
